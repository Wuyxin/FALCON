"use strict";(self.webpackChunknni_webui=self.webpackChunknni_webui||[]).push([[467],{25118:function(e,t,a){var i=a(16449),n=a(97391),s=a.n(n),r=a(4512),o=a.n(r),l=a(22379),c=a(93272),d=a(63700),m=a(41772);const u=({value:e,hideTooltip:t})=>{const a=(0,i.useRef)(null);return i.createElement("div",null,i.createElement(l.h,{iconProps:{iconName:"Copy"},styles:{icon:[{fontSize:c.TS.small}]},onClick:t=>{t.stopPropagation(),o()(e),a.current&&a.current.show(),setTimeout((()=>{null!==a.current&&a.current.dismiss()}),1e3)},onMouseDown:e=>{e.stopPropagation()},onMouseUp:e=>{e.stopPropagation()}}),i.createElement(d.G,{hidden:t,content:"Copied",componentRef:a,delay:0,tooltipProps:{calloutProps:{styles:{beak:{background:m.he},beakCurtain:{background:m.he},calloutMain:{background:m.he}}}}}))};u.propTypes={value:s().string.isRequired,hideTooltip:s().bool},t.Z=u},51342:function(e,t,a){a.d(t,{Z:function(){return P}});var i=a(16449),n=a(4512),s=a.n(n),r=a(87578),o=a(34487),l=a(39863),c=a(40487),d=a(12220),m=a(31820),u=a(41772),h=a(30965),p=a(4671);class g extends i.Component{constructor(e){super(e)}render(){const{eachLogpath:e,logName:t}=this.props,a=/^http/gi.test(e);return i.createElement("div",{className:"logpath"},i.createElement("span",{className:"logName"},t),a?i.createElement("a",{className:"logContent logHref",rel:"noopener noreferrer",href:e,target:"_blank"},e):i.createElement("span",{className:"logContent"},e))}}var f=g;class y extends i.Component{constructor(e){super(e)}render(){const{logString:e,id:t,logCollect:a}=this.props;return i.createElement("div",null,""===e?null:i.createElement("div",null,a?i.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:`${u.uQ}/trial_${t}.log`,style:{marginRight:10}},"Trial stdout"):i.createElement(f,{eachLogpath:e,logName:"Trial stdout:"})))}}var S=y;class E extends i.Component{constructor(e){super(e)}render(){const{logStr:e,id:t,logCollection:a}=this.props,n=-1!==e.indexOf(",");return i.createElement("div",null,i.createElement("div",null,n?i.createElement("div",null,a?i.createElement("div",null,i.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:`${u.uQ}/trial_${t}.log`,style:{marginRight:10}},"Trial stdout"),i.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:e.split(",")[1]},"NFS log")):i.createElement("div",null,i.createElement(f,{eachLogpath:e.split(",")[0],logName:"Trial stdout:"}),i.createElement(f,{eachLogpath:e.split(",")[1],logName:"Log on NFS:"}))):i.createElement(S,{logString:e,id:t,logCollect:a})))}}var v=E;class b extends i.Component{constructor(e){super(e)}render(){const{logStr:e}=this.props;return i.createElement("div",null,i.createElement(f,{eachLogpath:e,logName:"Log path:"}))}}var C=b,N=a(39564),x=a(73269),I=a(84244);a(47865);class k extends i.Component{constructor(e){super(e),this.state={panelInnerHeight:window.innerHeight}}setLogPanelHeight=()=>{this.setState((()=>({panelInnerHeight:window.innerHeight,innerWidth:window.innerWidth})))};async componentDidMount(){window.addEventListener("resize",this.setLogPanelHeight)}componentWillUnmount(){window.removeEventListener("resize",this.setLogPanelHeight)}render(){const{hideConfigPanel:e,panelName:t,panelContent:a}=this.props,{panelInnerHeight:n}=this.state,s=(0,p.yG)(n);return i.createElement(r.K,null,i.createElement(x.s,{isOpen:!0,hasCloseButton:!1,isFooterAtBottom:!0,isLightDismiss:!0,onLightDismissClick:e},i.createElement("div",{className:"panel"},i.createElement("div",null,i.createElement("div",{className:"panelName"},t),i.createElement(I.ZP,{height:s,language:"json",theme:"vs-light",value:a,options:{minimap:{enabled:!1},readOnly:!0,automaticLayout:!0,wordWrap:"on"}})),i.createElement(c.K,{text:"Close",className:"configClose",onClick:e}))))}}var T=k;a(18394),a(78587);class w extends i.Component{constructor(e){super(e),this.state={typeInfo:"",info:"",isHidenInfo:!0,showRetiaParamPanel:!1}}hideMessageInfo=()=>{this.setState((()=>({isHidenInfo:!0})))};hideRetiaParam=()=>{this.setState((()=>({showRetiaParamPanel:!1})))};isshowRetiaParamPanel=()=>{this.setState((()=>({showRetiaParamPanel:!0})))};getCopyStatus=(e,t)=>{this.setState((()=>({info:e,typeInfo:t,isHidenInfo:!1}))),setTimeout(this.hideMessageInfo,2e3)};copyParams=e=>{const t=JSON.stringify((0,p.cJ)(e.description.parameters),null,4);s()(t)?this.getCopyStatus("Success copy parameters to clipboard in form of python dict !","success"):this.getCopyStatus("Failed !","error")};openTrialLog=e=>{window.open(`${u.zU}/trial-file/${this.props.trialId}/${e}`)};openModelOnnx=()=>{window.open(`/netron/index.html?url=${u.zU}/trial-file/${this.props.trialId}/model.onnx`)};render(){const{isHidenInfo:e,typeInfo:t,info:a,showRetiaParamPanel:n}=this.state,s=this.props.trialId,g=h.F.getTrial(s),f=g.info.logPath||"This trial's log path is not available.",y=g.description.parameters,S=u.qp in y;return i.createElement(r.K,{className:"openRow"},i.createElement(r.K,{className:"openRowContent"},i.createElement(o.o,null,i.createElement(l.M,{headerText:"Parameters",key:"1",itemIcon:"TestParameter"},void 0!==g.info.hyperParameters?i.createElement(r.K,{id:"description"},i.createElement(r.K,{className:"bgHyper"},i.createElement(m.Z,{hideRoot:!0,shouldExpandNode:()=>!0,getItemString:()=>null,data:(0,p.cJ)(y)})),i.createElement(r.K,{horizontal:!0,className:"copy"},i.createElement(c.K,{onClick:this.copyParams.bind(this,g),text:"Copy as json",styles:{root:{width:128,marginRight:10}}}),S&&i.createElement(d.a,{onClick:this.isshowRetiaParamPanel,text:"Original parameters"}),!e&&i.createElement(N.Z,{typeInfo:t,info:a}),n&&i.createElement(T,{hideConfigPanel:this.hideRetiaParam,panelName:"Retiarii parameters",panelContent:JSON.stringify(y,null,2)}))):i.createElement(r.K,{className:"logpath"},i.createElement("span",{className:"logName"},"Error: "),i.createElement("span",{className:"error"},"This trial's parameters are not available.'"))),i.createElement(l.M,{headerText:"Log",key:"2",itemIcon:"M365InvoicingLogo"},"local"!==h.O.trainingServicePlatform?i.createElement(v,{logStr:f,id:s,logCollection:h.O.logCollectionEnabled}):i.createElement("div",null,i.createElement(C,{logStr:f,id:s}),i.createElement("div",{id:"trialog"},i.createElement("div",{className:"copy",style:{marginTop:15}},i.createElement(c.K,{onClick:this.openTrialLog.bind(this,"trial.log"),text:"View trial log"}),i.createElement(c.K,{onClick:this.openTrialLog.bind(this,"stderr"),text:"View trial error",styles:{root:{marginLeft:15}}}),i.createElement(c.K,{onClick:this.openTrialLog.bind(this,"stdout"),text:"View trial stdout",styles:{root:{marginLeft:15}}}))))),h.O.metadata.tag.includes("retiarii")?i.createElement(l.M,{headerText:"Visualization",key:"3",itemIcon:"FlowChart"},i.createElement("div",{id:"visualization"},i.createElement("div",{id:"visualizationText"},"Visualize models with 3rd-party tools."),i.createElement(c.K,{onClick:this.openModelOnnx.bind(this),text:"Netron",styles:{root:{marginLeft:15}}}))):null)))}}var P=w},56919:function(e,t,a){a.d(t,{W:function(){return s}});var i=a(93272);const n=(0,i.gh)(),s=(0,i.ZC)({buttonArea:{verticalAlign:"top",display:"inline-block",textAlign:"center",minWidth:30,height:30},callout:{maxWidth:300},header:{padding:"18px 24px 12px"},title:[n.fonts.xLarge,{margin:0,color:n.palette.neutralPrimary,fontWeight:i.lq.semilight}],inner:{height:"100%",padding:"0 24px 20px"},actions:{position:"relative",marginTop:20,width:"100%",whiteSpace:"nowrap"},subtext:[n.fonts.small,{margin:0,color:n.palette.neutralPrimary,fontWeight:i.lq.semilight}],link:[n.fonts.medium,{color:n.palette.neutralPrimary}],buttons:{display:"flex",justifyContent:"flex-end",padding:"0 24px 24px"}})},90019:function(e,t,a){a.r(t),a.d(t,{default:function(){return Ve}});var i=a(16449),n=a(34487),s=a(39863),r=a(87578),o=a(30965),l=a(77060),c=a(38450),d=a(78800),m=a(4671);a(52353),a(38570),a(21258);class u extends i.Component{constructor(e){super(e),this.state={startDuration:0,endDuration:100,durationSource:this.initDuration(this.props.source)}}initDuration=e=>{const t=[],a=[];return e.filter(m.k_).forEach((e=>{t.push(e.sequenceId),a.push(e.duration)})),{tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:e=>"<div><div>Trial No.: "+e[0].dataIndex+"</div><div>Duration: "+(0,m.BG)(e[0].data)+"</div></div>"},grid:{bottom:"3%",containLabel:!0,left:"1%",right:"5%"},dataZoom:[{id:"dataZoomY",type:"inside",yAxisIndex:[0],filterMode:"empty",start:0,end:100}],xAxis:{name:"Time/s",type:"value"},yAxis:{name:"Trial No.",type:"category",data:t,nameTextStyle:{padding:[0,0,0,30]}},series:[{type:"bar",data:a}]}};getOption=e=>{const{startDuration:t,endDuration:a}=this.state;return{tooltip:{trigger:"axis",axisPointer:{type:"shadow"},enterable:!0,formatter:e=>`<div class="tooldetailAccuracy">\n                        <div>Trial No.: ${e[0].dataIndex}</div>\n                        <div>Duration: ${(0,m.BG)(e[0].data)}</div>\n                    </div>\n                    `},grid:{bottom:"3%",containLabel:!0,left:"1%",right:"5%"},dataZoom:[{id:"dataZoomY",type:"inside",yAxisIndex:[0],filterMode:"empty",start:t,end:a}],xAxis:{name:"Time",type:"value"},yAxis:{name:"Trial",type:"category",data:e.trialId,nameTextStyle:{padding:[0,0,0,30]}},series:[{type:"bar",data:e.trialTime}]}};drawDurationGraph=e=>{const t=[],a=[],i=[],n=e.filter(m.k_);Object.keys(n).map((e=>{const i=n[e];t.push(i.sequenceId),a.push(i.duration)})),i.push({trialId:t,trialTime:a}),this.setState({durationSource:this.getOption(i[0])})};componentDidMount(){const{source:e}=this.props;this.drawDurationGraph(e)}componentDidUpdate(e){this.props.source!==e.source&&this.drawDurationGraph(this.props.source)}render(){const{durationSource:e}=this.state,t={dataZoom:this.durationDataZoom};return i.createElement("div",{className:"graph"},i.createElement(d.Z,{option:e,style:{width:"94%",height:412,margin:"0 auto",marginTop:15},theme:"nni_theme",notMerge:!0,onEvents:t}))}durationDataZoom=e=>{void 0!==e.batch&&this.setState((()=>({startDuration:null!==e.batch[0].start?e.batch[0].start:0,endDuration:null!==e.batch[0].end?e.batch[0].end:100})))}}var h=u,p=a(43012),g=a(12220),f=a(87735),y=a(86815),S=a(60002),E=a(59327),v=a(96964),b=a(75119),C=a(40487);class N extends i.Component{constructor(e){super(e),this.state={currentSelected:this.props.selectedColumns}}makeChangeHandler=e=>(t,a)=>this.onCheckboxChange(t,e,a);onCheckboxChange=(e,t,a)=>{const i=[...this.state.currentSelected];if(!0===a)i.includes(t)||(i.push(t),this.setState({currentSelected:i}));else{const e=i.filter((e=>e!==t));this.setState({currentSelected:e})}};saveUserSelectColumn=()=>{const{currentSelected:e}=this.state,{allColumns:t,onSelectedChange:a,whichComponent:i}=this.props,n=t.map((e=>e.key)).filter((t=>e.includes(t)));a(n),"table"===i?localStorage.setItem("columns",JSON.stringify(n)):localStorage.setItem("paraColumns",JSON.stringify(n)),this.hideDialog()};cancelOption=()=>{this.setState({currentSelected:this.props.selectedColumns},(()=>{this.hideDialog()}))};hideDialog=()=>{this.props.onHideDialog()};render(){const{allColumns:e,minSelected:t}=this.props,{currentSelected:a}=this.state;return i.createElement("div",null,i.createElement(S.V,{hidden:!1,dialogContentProps:{type:E.i.largeHeader,title:"Customize columns",subText:"You can choose which columns you wish to see."},modalProps:{isBlocking:!1,styles:{main:{maxWidth:450}}}},i.createElement("div",{className:"columns-height"},e.map((e=>i.createElement(v.X,{key:e.key,label:e.name,checked:a.includes(e.key),onChange:this.makeChangeHandler(e.key),styles:{root:{marginBottom:8}}})))),i.createElement(b.c,null,i.createElement(C.K,{text:"Save",onClick:this.saveUserSelectColumn,disabled:a.length<(void 0===t?1:t)}),i.createElement(g.a,{text:"Cancel",onClick:this.cancelOption}))))}}var x=N;a(54438);class I extends i.Component{paraRef=i.createRef();chartMulineStyle={width:"100%",height:392,margin:"0 auto"};innerChartMargins={top:32,right:20,bottom:20,left:28};constructor(e){super(e),this.state={dimName:[],primaryMetricKey:"default",selectedPercent:"1",noChart:!0,customizeColumnsDialogVisible:!1,availableDimensions:[],chosenDimensions:null!==localStorage.getItem("paraColumns")?JSON.parse(localStorage.getItem("paraColumns")):[]}}percentNum=(e,t)=>{void 0!==t&&this.setState({selectedPercent:t.key.toString()},(()=>{this.renderParallelCoordinates()}))};updateEntries=(e,t)=>{void 0!==t&&this.setState({primaryMetricKey:t.key},(()=>{this.renderParallelCoordinates()}))};componentDidMount(){this.renderParallelCoordinates()}componentDidUpdate(e){this.props.trials===e.trials&&this.props.searchSpace===e.searchSpace||this.renderParallelCoordinates()}render(){const{selectedPercent:e,noChart:t,customizeColumnsDialogVisible:a,availableDimensions:n,chosenDimensions:s}=this.state;return i.createElement("div",{className:"parameter"},i.createElement(r.K,{horizontal:!0,className:"para-filter",horizontalAlign:"end"},i.createElement(g.a,{text:"Add/Remove axes",onClick:()=>{this.setState({customizeColumnsDialogVisible:!0})},styles:{root:{marginRight:10}}}),i.createElement(f.L,{selectedKey:e,onChange:this.percentNum,options:[{key:"0.01",text:"Top 1%"},{key:"0.05",text:"Top 5%"},{key:"0.2",text:"Top 20%"},{key:"1",text:"Top 100%"}],styles:{dropdown:{width:120}},className:"para-filter-percent"}),this.finalKeysDropdown()),a&&n.length>0&&i.createElement(x,{selectedColumns:s,allColumns:n.map((e=>({key:e,name:e}))),onSelectedChange:e=>{this.setState({chosenDimensions:e},(()=>{this.renderParallelCoordinates()}))},onHideDialog:()=>{this.setState({customizeColumnsDialogVisible:!1})},minSelected:2,whichComponent:"para"}),i.createElement("div",{className:"parcoords",style:this.chartMulineStyle,ref:this.paraRef}),t&&i.createElement("div",{className:"nodata"},"No data"))}finalKeysDropdown(){const{primaryMetricKey:e}=this.state;if(1===o.F.finalKeys().length)return null;{const t=[];return o.F.finalKeys().forEach((e=>{t.push({key:e,text:e})})),i.createElement("div",null,i.createElement("span",{className:"para-filter-text para-filter-middle"},"Metrics"),i.createElement(f.L,{selectedKey:e,options:t,onChange:this.updateEntries,styles:{root:{width:150,display:"inline-block"}},className:"para-filter-percent"}))}}renderParallelCoordinates(){const{searchSpace:e}=this.props,t=parseFloat(this.state.selectedPercent),{primaryMetricKey:a,chosenDimensions:i}=this.state,n=o.F.inferredSearchSpace(e),s=o.F.inferredMetricSpace();let r=this.getTrialsAsObjectList(n,s);const l=[];let c,d;for(const[o,u]of n.axes)l.push([o,{type:"number",yscale:this.convertToD3Scale(u)}]);for(const[u,h]of s.axes){const e=this.convertToD3Scale(h);if(u===a&&void 0!==e&&e.interpolate){if(d=this.convertToD3Scale(h,!1),r.sort(((e,t)=>"minimize"===o.O.optimizeMode?e[u]-t[u]:t[u]-e[u])),1!=t){const a=Math.max(Math.ceil(r.length*t),1);r=r.slice(0,a);const i=p.Wem(r,(e=>e[u]));e.domain([i[0],i[1]]),d.domain([i[0],i[1]]),void 0!==d&&d.domain(i)}r.reverse();const a=e=>{e.range([0,1]);const[t,a]=e.domain(),i=e.invert(.5);e.domain([t,i,a]).range(["#90EE90","#FFC400","#CA0000"]).interpolate(p.USs)};a(d),c=u}l.push([u,{type:"number",yscale:e}])}if(0===r.length||l.length<=1)return;const m=void 0===this.pcs;m&&(this.pcs=(0,y.Z)()(this.paraRef.current)),this.pcs.data(r).dimensions(l.filter((([e,t])=>0===i.length||i.includes(e))).reduce(((e,t)=>({...e,[t[0]]:t[1]})),{})),m&&this.pcs.margin(this.innerChartMargins).alphaOnBrushed(.2).smoothness(.1).brushMode("1D-axes").reorderable().interactive(),void 0!==d&&this.pcs.color((e=>d(e[c]))),this.pcs.render(),m&&this.setState({noChart:!1}),this.setState({availableDimensions:l.map((e=>e[0])),chosenDimensions:0===i.length?l.map((e=>e[0])):i})}getTrialsAsObjectList(e,t){const{trials:a}=this.props;return a.filter(m.mj).map((a=>{const i=Array.from(a.parameters(e).entries());i.push(...Array.from(a.metrics(t).entries()));const n={};for(const[e,t]of i)n[e.fullName]=t;return n}))}getRange(){return[this.chartMulineStyle.height-this.innerChartMargins.top-this.innerChartMargins.bottom,1]}convertToD3Scale(e,t=!0){const a=([e,t],a=.1)=>{const i=(t-e)*a/2;return[e-i,t+i]};let i;return"ordinal"===e.scale?i=e.nested?p.q2y().domain(Array.from(e.domain.keys())).padding(.2):p.q2y().domain(e.domain).padding(.2):"log"===e.scale?i=p.p2C().domain((([e,t],i=.1)=>{const[n,s]=a([Math.log(e),Math.log(t)],i);return[Math.exp(n),Math.exp(s)]})(e.domain)):"linear"===e.scale&&(i=p.BYU().domain(a(e.domain))),t&&(i=i.range(this.getRange())),i}}var k=I,T=a(23270);const w={childrenGap:20};class P extends i.Component{static intervalMediate=1;constructor(e){super(e),this.state={detailSource:[],interSource:{},filterSource:[],eachIntermediateNum:1,isLoadconfirmBtn:!1,isFilter:!1,length:1e5,clickCounts:0,startMediaY:0,endMediaY:100}}drawIntermediate=e=>{if(e.length>0){this.setState({length:e.length,detailSource:e});const{startMediaY:t,endMediaY:a}=this.state,i=[];Object.keys(e).map((t=>{const a=e[t];i.push({name:a.id,trialNum:a.sequenceId,data:a.description.intermediate,type:"line",hyperPara:a.description.parameters})})),i.sort(((e,t)=>t.data.length-e.data.length));const n=[],s=i[0].data.length,r=[];Object.keys(i).map((e=>{const t=i[e];n.push(t.name)}));for(let e=1;e<=s;e++)r.push(e);const o={tooltip:{trigger:"item",enterable:!0,confine:!0,formatter:function(e){const t=e.seriesName;let a={},n=0;const s=i.find((e=>e.name===t));return void 0!==s&&(a=s.hyperPara,n=s.trialNum),`\n                            <div class="tooldetailAccuracy">\n                                <div>Trial No.: ${n}</div> \n                                <div>Trial ID: ${t}</div>\n                                <div>Intermediate: ${e.data}</div>\n                                <div>Parameters: <pre>${JSON.stringify((0,m.cJ)(a),null,4)}</pre>\n                                </div>\n                            </div>\n                        `}},grid:{left:"5%",top:40,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:r},yAxis:{type:"value",name:"Metric",scale:!0},dataZoom:[{id:"dataZoomY",type:"inside",yAxisIndex:[0],filterMode:"none",start:t,end:a}],series:i};this.setState({interSource:o})}else{const e={grid:{left:"5%",top:40,containLabel:!0},xAxis:{type:"category",boundaryGap:!1},yAxis:{type:"value",name:"Metric"}};this.setState({interSource:e})}};filterLines=()=>{const e=[];this.setState({isLoadconfirmBtn:!0},(()=>{const{source:t}=this.props,a=null!==this.pointInput?this.pointInput.value:"",i=null!==this.minValInput?this.minValInput.value:"",n=null!==this.maxValInput?this.maxValInput.value:"";if(""===a||""===i)alert("Please input filter message");else{const s=JSON.parse(a),r=JSON.parse(i);if(""===n)Object.keys(t).map((a=>{const i=t[a];i.description.intermediate[s-1]>=r&&e.push(i)}));else{const a=JSON.parse(n);Object.keys(t).map((i=>{const n=t[i],o=n.description.intermediate[s-1];o>=r&&o<=a&&e.push(n)}))}this.setState({filterSource:e}),this.drawIntermediate(e)}const s=this.state.clickCounts+1;this.setState({isLoadconfirmBtn:!1,clickCounts:s})}))};switchTurn=(e,t)=>{this.setState({isFilter:t}),!1===t&&this.drawIntermediate(this.props.source)};componentDidMount(){const{source:e}=this.props;this.drawIntermediate(e)}componentDidUpdate(e,t){if(this.props.source!==e.source||this.state.isFilter!==t.isFilter){const{isFilter:e,filterSource:t}=this.state,{source:a}=this.props;if(!0===e){const e=null!==this.pointInput?this.pointInput.value:"",i=null!==this.minValInput?this.minValInput.value:"";""===e&&""===i?this.drawIntermediate(a):this.drawIntermediate(t)}else this.drawIntermediate(a)}}render(){const{interSource:e,isLoadconfirmBtn:t,isFilter:a}=this.state,n={dataZoom:this.intermediateDataZoom};return i.createElement("div",null,i.createElement(r.K,{horizontal:!0,horizontalAlign:"end",tokens:w,className:"meline intermediate"},a?i.createElement("div",null,i.createElement("span",{className:"filter-x"},"# Intermediate result"),i.createElement("input",{ref:e=>this.pointInput=e,className:"strange"}),i.createElement("span",null,"Metric range"),i.createElement("input",{ref:e=>this.minValInput=e}),i.createElement("span",{className:"hyphen"},"-"),i.createElement("input",{ref:e=>this.maxValInput=e}),i.createElement(C.K,{text:"Confirm",onClick:this.filterLines,disabled:t})):null,i.createElement(r.K,{horizontal:!0,className:"filter-toggle"},i.createElement("span",null,"Filter"),i.createElement(T.Z,{onChange:this.switchTurn}))),i.createElement("div",{className:"intermediate-graph graph"},i.createElement(d.Z,{option:e,style:{width:"100%",height:400,margin:"0 auto"},notMerge:!0,onEvents:n}),i.createElement("div",{className:"xAxis"},"# Intermediate result")))}intermediateDataZoom=e=>{void 0!==e.batch&&this.setState((()=>({startMediaY:null!==e.batch[0].start?e.batch[0].start:0,endMediaY:null!==e.batch[0].end?e.batch[0].end:100})))}}var D=P,M=a(89623),L=a(63700),O=a(45546),K=a(13994),_=a(41772),A=a(93272);const R=(0,A.ZC)({menu:{textAlign:"center",maxWidth:600,selectors:{".ms-ContextualMenu-item":{height:"auto"}}},item:{display:"inline-block",width:40,height:40,lineHeight:40,textAlign:"center",verticalAlign:"middle",marginBottom:8,cursor:"pointer",selectors:{"&:hover":{backgroundColor:"#eaeaea"}}},categoriesList:{margin:0,padding:0,listStyleType:"none"},button:{width:"40%",margin:"2%"}});function F(e){return"StatusNNI"===e?_.S3.map((e=>({key:e,text:e}))):o.O.searchSpace[e]._value.map((e=>({key:e.toString(),text:e.toString()})))}const z=(e,t,a)=>{const i=((e,t)=>{const a=[],i=JSON.parse(JSON.stringify(e));return i.forEach((e=>{"number"===t.get(e.name)&&(!0===e.isChoice?(e.choice.forEach((e=>{a.push(JSON.parse(e))})),e.choice=a):(e.value1=JSON.parse(e.value1),""!==e.value2&&(e.value2=JSON.parse(e.value2))))})),i})(t,a);return i.forEach((t=>{if("Trial id"===t.name)e=e.filter((e=>e.id.toUpperCase().includes(t.value1.toUpperCase())));else if("Trial No."===t.name)e=e.filter((e=>e.sequenceId.toString()===t.value1));else if("StatusNNI"===t.name)e=$(e,t,"status");else{const a=`space/${t.name}`;e=!0===t.isChoice?$(e,t,t.name):"="===t.operator?e.filter((e=>e[a]===t.value1)):">"===t.operator?e.filter((e=>e[a]>t.value1)):"<"===t.operator?e.filter((e=>e[a]<t.value1)):"between"===t.operator?e.filter((e=>e[a]>t.value1&&e[a]<t.value2)):e.filter((e=>e[a]!==t.value1))}})),e};function W(e,t,a){const i=[],n="status"===a?"status":`space/${a}`;return e.forEach((e=>{t.forEach((t=>{e[n]===t&&i.push(e)}))})),i}function $(e,t,a){if("="===t.operator)return W(e,t.choice,a);{let i;return i="status"===a?_.S3.filter((e=>!new Set(t.choice).has(e))):o.O.searchSpace[a]._value.filter((e=>!new Set(t.choice).has(e))),W(e,i,a)}}function H(e){let t="";return e.forEach((e=>{const a="StatusNNI"===e.name?"Status":e.name;!1===e.isChoice?"Trial id"===e.name||"Trial No."===e.name?t+=`${e.name}:${e.value1}; `:["=","\u2260",">","<"].includes(e.operator)?t+=`${a}${"="===e.operator?":":e.operator}${e.value1}; `:t+=`${a}:[${e.value1},${e.value2}]; `:t+=`${a}${"="===e.operator?":":"\u2260"}[${[...e.choice]}]; `})),t}function V(e){let t=!1;return"StatusNNI"===e&&(t=!0),e in o.O.searchSpace&&(t="choice"===o.O.searchSpace[e]._type),t}var B=a(20053),J=a(44809),Z=a(19382),j=a(75537),q=a(22379);const U=(0,A.gh)(),Y=(0,A.ZC)({container:{display:"flex",flexFlow:"column nowrap",alignItems:"stretch"},header:[U.fonts.xLargePlus,{flex:"1 1 auto",borderTop:`4px solid ${U.palette.themePrimary}`,color:U.palette.neutralPrimary,display:"flex",fontSize:A.TS.xLarge,alignItems:"center",fontWeight:A.lq.semibold,padding:"12px 12px 14px 24px"}],body:{flex:"4 4 auto",padding:"0 24px 24px 24px",overflowY:"hidden",selectors:{p:{margin:"14px 0"},"p:first-child":{marginTop:0},"p:last-child":{marginBottom:0}}}}),G=(0,A.ZC)({root:{color:U.palette.neutralPrimary,marginLeft:"auto",marginTop:"4px",marginRight:"2px"},rootHovered:{color:U.palette.neutralDark}});const Q={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:Z.r};function X(e,t){const a=[];for(const i of e.intermediates){if(void 0===i)break;const e=(0,m.Ti)(i.data);"object"===typeof e?a.push(e[t]):a.push(e)}return a}class ee extends i.Component{constructor(e){super(e),this.state={intermediateKey:void 0!==this.props.intermediateKeyList?this.props.intermediateKeyList[0]:"default"}}_generateTooltipSummary=(e,t)=>(0,J.renderToString)(i.createElement("div",{className:"tooldetailAccuracy"},i.createElement("div",null,"Trial No.: ",e.sequenceId),i.createElement("div",null,"Trial ID: ",e.id),i.createElement("div",null,"Intermediate metric: ",t)));_intermediates(e){const t=Math.max(...e.map((e=>e.intermediates.length))),a=Array(t).fill(0).map(((e,t)=>t+1)),n=e.map((e=>({name:e.id,data:e.intermediates,type:"line"}))),s=n.map((e=>e.name)),r={tooltip:{trigger:"item",enterable:!0,confine:!0,formatter:t=>{const a=e.find((e=>e.id===t.seriesName));return this._generateTooltipSummary(a,t.data)}},grid:{left:"5%",top:40,containLabel:!0},legend:{type:"scroll",right:40,left:s.length>6?"15%":null,data:s},xAxis:{type:"category",boundaryGap:!1,data:a},yAxis:{type:"value",name:"Metric",scale:!0},series:n};return i.createElement("div",{className:"graph"},i.createElement(d.Z,{option:r,style:{width:"100%",height:418,margin:"0 auto"},notMerge:!0}))}_renderRow(e,t,a,n,s){return i.createElement("tr",{key:e},i.createElement("td",{className:"column"},t),n.map((e=>i.createElement("td",{className:a,key:e.id},s(e)||"--"))))}_overlapKeys(e){const t=[];for(const a of e[0].keys()){let i=!0;for(const t of e)if(!Array.from(t.keys()).includes(a)){i=!1;break}i&&t.push(a)}return t}_columns(e){const t=window.innerWidth;let a="";a=t>1200?e.length>3?"flex":"":t<700?e.length>1?"flex":"":e.length>2?"flex":"";const n=this._overlapKeys(e.map((e=>e.parameters))),s=this._overlapKeys(e.map((e=>e.metrics)));return i.createElement("table",{className:`compare-modal-table ${a}`},i.createElement("tbody",null,this._renderRow("id","ID","value idList",e,(e=>e.id)),this._renderRow("trialnum","Trial No.","value",e,(e=>e.sequenceId.toString())),this._renderRow("duration","Duration","value",e,(e=>e.duration)),n.map((t=>this._renderRow(`space_${t}`,t,"value",e,(e=>e.parameters.get(t))))),void 0!==s?s.map((t=>this._renderRow(`metrics_${t}`,`Metric: ${t}`,"value",e,(e=>e.metrics.get(t))))):null))}closeCompareModal=()=>{const{showDetails:e,changeSelectTrialIds:t,onHideDialog:a}=this.props;!0===e&&t(),a()};selectOtherKeys=(e,t)=>{void 0!==t&&this.setState((()=>({intermediateKey:t.text})))};render(){const{trials:e,title:t,showDetails:a,intermediateKeyList:n}=this.props,{intermediateKey:s}=this.state,l=void 0!==n?n:[],c=e=>new Map(Array.from(e).map((([e,t])=>[e.baseName,t]))),d=o.F.inferredSearchSpace(o.O.searchSpaceNew),u=e.map((e=>({id:e.id,sequenceId:e.sequenceId,duration:(0,m.BG)(e.duration),parameters:c(e.parameters(d)),metrics:c(e.metrics(o.F.inferredMetricSpace())),intermediates:X(e,s)})));return i.createElement(j.u,{isOpen:!0,containerClassName:Y.container,className:"compare-modal",allowTouchBodyScroll:!0,dragOptions:Q,onDismiss:this.closeCompareModal},i.createElement("div",null,i.createElement("div",{className:Y.header},i.createElement("span",null,t),i.createElement(q.h,{styles:G,iconProps:{iconName:"Cancel"},ariaLabel:"Close popup modal",onClick:this.closeCompareModal})),l.length>1||1===l.length&&l!==["default"]?i.createElement(r.K,{horizontalAlign:"end",className:"selectKeys"},i.createElement(f.L,{className:"select",selectedKey:s,options:l.map(((e,t)=>({key:e,text:l[t]}))),onChange:this.selectOtherKeys})):null,i.createElement(r.K,{className:"compare-modal-intermediate"},this._intermediates(u),i.createElement(r.K,{className:"compare-yAxis"},"# Intermediate result")),a&&i.createElement(r.K,null,this._columns(u))))}}var te=ee,ae=a(36177),ie=a.n(ae);class ne extends i.Component{constructor(e){super(e),this.state={isShowSubmitSucceed:!1,isShowSubmitFailed:!1,isShowWarning:!1,searchSpace:o.O.searchSpace,copyTrialParameter:{},customParameters:{},customID:NaN,changeMap:new Map}}getFinalVal=e=>{const{name:t,value:a}=e.target,{changeMap:i}=this.state;this.setState({changeMap:i.set(t,a)})};addNewTrial=()=>{const{searchSpace:e,copyTrialParameter:t,changeMap:a}=this.state,i=JSON.parse(JSON.stringify(t));a.forEach((function(e,t){i[t]=e}));let n=!1;Object.keys(i).map((a=>{if("tag"!==a){if(("number"===typeof t[a]&&"string"===typeof i[a]||"boolean"===typeof t[a]&&"string"===typeof i[a])&&(i[a]=JSON.parse(i[a])),void 0===e[a])return;if("choice"===e[a]._type){if(void 0===e[a]._value.find((e=>e===i[a])))return void(n=!0)}else if(i[a]<e[a]._value[0]||i[a]>e[a]._value[1])return void(n=!0)}})),!1!==n?this.setState((()=>({isShowWarning:!0,customParameters:i}))):this.submitCustomize(i)};warningConfirm=()=>{this.setState((()=>({isShowWarning:!1})));const{customParameters:e}=this.state;this.submitCustomize(e)};warningCancel=()=>{this.setState((()=>({isShowWarning:!1})))};submitCustomize=e=>{for(const t in e)"tag"===t&&delete e[t];ie()(`${_.zU}/trial-jobs`,{method:"POST",headers:{"Content-Type":"application/json"},data:e}).then((e=>{200===e.status?(this.setState((()=>({isShowSubmitSucceed:!0,customID:e.data.sequenceId}))),this.props.closeCustomizeModal()):this.setState((()=>({isShowSubmitFailed:!0})))})).catch((()=>{this.setState((()=>({isShowSubmitFailed:!0})))}))};closeSucceedHint=()=>{this.setState((()=>({isShowSubmitSucceed:!1,changeMap:new Map}))),this.props.closeCustomizeModal()};closeFailedHint=()=>{this.setState((()=>({isShowSubmitFailed:!1,changeMap:new Map}))),this.props.closeCustomizeModal()};componentDidMount(){const{copyTrialId:e}=this.props;if(void 0!==e&&void 0!==o.F.getTrial(e)){const t=o.F.getTrial(e).description.parameters;this.setState((()=>({copyTrialParameter:t})))}}componentDidUpdate(e){if(this.props.copyTrialId!==e.copyTrialId){const{copyTrialId:e}=this.props;if(void 0!==e&&void 0!==o.F.getTrial(e)){const t=o.F.getTrial(e).description.parameters;this.setState((()=>({copyTrialParameter:t})))}}}render(){const{closeCustomizeModal:e,visible:t}=this.props,{isShowSubmitSucceed:a,isShowSubmitFailed:n,isShowWarning:s,customID:o,copyTrialParameter:l}=this.state;return i.createElement(r.K,null,i.createElement(S.V,{hidden:!t,dialogContentProps:{type:E.i.largeHeader,title:"Customized trial setting",subText:"You can submit a customized trial."},modalProps:{isBlocking:!1,styles:{main:{maxWidth:450}}}},i.createElement("form",{className:"hyper-box"},Object.keys(l).map((e=>i.createElement(r.K,{horizontal:!0,key:e,className:"hyper-form"},i.createElement(K.v,{styles:{root:{minWidth:100}},className:"title"},e),i.createElement(K.v,{className:"inputs"},i.createElement("input",{type:"text",name:e,defaultValue:l[e],onChange:this.getFinalVal})))))),i.createElement(b.c,null,i.createElement(C.K,{text:"Submit",onClick:this.addNewTrial}),i.createElement(g.a,{text:"Cancel",onClick:e}))),i.createElement(S.V,{hidden:!a,onDismiss:this.closeSucceedHint,dialogContentProps:{type:E.i.normal,title:i.createElement("div",{className:"icon-color"},B.d8,i.createElement("b",null,"Submit successfully")),closeButtonAriaLabel:"Close",subText:`You can find your customized trial by Trial No.${o}`},modalProps:{isBlocking:!1,styles:{main:{minWidth:500}}}},i.createElement(b.c,null,i.createElement(C.K,{onClick:this.closeSucceedHint,text:"OK"}))),i.createElement(S.V,{hidden:!n,onDismiss:this.closeSucceedHint,dialogContentProps:{type:E.i.normal,title:i.createElement("div",{className:"icon-error"},B.of,"Submit Failed"),closeButtonAriaLabel:"Close",subText:"Unknown error."},modalProps:{isBlocking:!1,styles:{main:{minWidth:500}}}},i.createElement(b.c,null,i.createElement(C.K,{onClick:this.closeFailedHint,text:"OK"}))),i.createElement(S.V,{hidden:!s,onDismiss:this.closeSucceedHint,dialogContentProps:{type:E.i.normal,title:i.createElement("div",{className:"icon-error"},B.uQ,"Warning"),closeButtonAriaLabel:"Close",subText:"The parameters you set are not in our search space, this may cause the tuner to crash, Are you sure you want to continue submitting?"},modalProps:{isBlocking:!1,styles:{main:{minWidth:500}}}},i.createElement(b.c,null,i.createElement(C.K,{onClick:this.warningConfirm,text:"Confirm"}),i.createElement(g.a,{onClick:this.warningCancel,text:"Cancel"}))))}}var se=ne,re=a(97391),oe=a.n(re);function le(e){const{isReaptedStartTensorboard:t,onHideDialog:a,item:n,isShowTensorboardDetail:s,errorMessage:r}=e,o={type:E.i.normal,title:`${s?n.id:"TensorBoard"}`};return i.createElement(S.V,{hidden:!1,dialogContentProps:o,modalProps:{className:"dialog"}},r.error?i.createElement("div",null,i.createElement("span",null,"Error message: ",r.message)):s?i.createElement("div",null,"This tensorBoard with trials: ",i.createElement("span",{className:"bold"},n.trialJobIdList.join(", ")),"."):t?i.createElement("div",null,"You had started this tensorBoard with these trials:",i.createElement("span",{className:"bold"},n.trialJobIdList.join(", ")),".",i.createElement("div",{className:"line-height"},"Its tensorBoard id: ",i.createElement("span",{className:"bold"},n.id))):i.createElement("div",null,"You are starting a new TensorBoard with trials:",i.createElement("span",{className:"bold"},n.trialJobIdList.join(", ")),".",i.createElement("div",{className:"line-height"},"TensorBoard id: ",i.createElement("span",{className:"bold"},n.id))),r.error?i.createElement(b.c,null,i.createElement(C.K,{onClick:a,text:"Close"})):i.createElement(b.c,null,i.createElement(C.K,{onClick:function(){const e=window.location.hostname,t=window.location.protocol;window.open(`${t}//${e}:${n.port}`),a()},text:""+(s?"See tensorBoard":"Ok")})))}le.propTypes={isReaptedStartTensorboard:oe().bool,isShowTensorboardDetail:oe().bool,onHideDialog:oe().func,item:oe().object,errorMessage:oe().object};var ce=le;function de(e){let t=0;const{selectedRowIds:a,changeSelectTrialIds:n}=e,[s,r]=(0,i.useState)([]),[o,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(!1),[p,f]=(0,i.useState)({}),[y,S]=(0,i.useState)({}),[E,v]=(0,i.useState)([0]);function b(){ie().get(`${_.zU}/tensorboard-tasks`).then((e=>{if(200===e.status&&(r(e.data),0!==e.data.length)){t=window.setTimeout(b,1e4);const e=E;e.push(t),v(e)}}))}function C(){E.forEach((e=>{window.clearTimeout(e)}))}const N=(0,m.DF)(a,s),x=(0,m.D8)(s,(function(){ie().delete(`${_.zU}/tensorboard-tasks`).then((e=>{200===e.status&&(r([]),C())}))}),(function(e){f(e),h(!0),d(!0)}));return(0,i.useEffect)((()=>(b(),function(){E.forEach((e=>{window.clearTimeout(e)}))})),[]),i.createElement(i.Fragment,null,i.createElement(g.a,{text:"TensorBoard",className:"elementMarginLeft",split:!0,splitButtonAriaLabel:"See 2 options","aria-roledescription":"split button",menuProps:x,onClick:()=>function(){const{selectedRowIds:t}=e;if(t.length>0){h(!1);const e=s.filter((e=>e.trialJobIdList.join(",")===t.join(",")));e.length>0?(l(!0),f(e[0]),d(!0)):(ie().post(`${_.zU}/tensorboard`,{trials:t.join(",")}).then((e=>{200===e.status&&(f(e.data),C(),b(),S({error:!1,message:""}),d(!0))})).catch((e=>{e.response&&S({error:!0,message:e.response.data.error||"Failed to start tensorBoard!"}),d(!0)})),l(!1))}else alert("Please select trials first!")}(),disabled:N}),0!==s.length?i.createElement("span",{className:"circle"},s.length):null,c&&i.createElement(ce,{isReaptedStartTensorboard:o,isShowTensorboardDetail:u,errorMessage:y,item:p,onHideDialog:()=>{d(!1),n()}}))}de.propTypes={selectedRowIds:oe().array,changeSelectTrialIds:oe().func};var me=de,ue=a(53102),he=a(81999);function pe(e){const{parameter:t,searchFilter:a,dismiss:n,changeSearchFilterList:s,updatePage:l,setSearchInputVal:c}=e,d="StatusNNI"===t||"choice"===o.O.searchSpace[t]._type,m=d?["=","\u2260"]:["between",">","<","=","\u2260"],u=function(){const e=[];if(a.length>0){const i=a.find((e=>e.name===t));void 0!==i?e.push(i.operator,i.value1.toString(),i.value2.toString(),i.choice.toString().split(",")):e.push(""+(d?"=":"between"),"","",[])}else e.push(""+(d?"=":"between"),"","",[]);return e}(),[h,p]=(0,i.useState)(u[0]),[g,y]=(0,i.useState)(u[1]),[S,E]=(0,i.useState)(u[2]),[v,b]=(0,i.useState)(u[3]);function N(e){y(e.target.value)}function x(){return""===S&&"between"===h?o.O.searchSpace[t]._value[1].toString():S}return i.createElement(r.K,{horizontal:!0,className:"filterConditions",tokens:he.O4},i.createElement(f.L,{selectedKey:h,options:m.map((e=>({key:e,text:e}))),onChange:function(e,t){void 0!==t&&p(t.key.toString())},className:"btn-vertical-middle",styles:{root:{width:100}}}),d?i.createElement(f.L,{selectedKeys:v,multiSelect:!0,options:F(t),onChange:function(e,t){if(void 0!==t){const e=t.selected?[...v,t.key]:v.filter((e=>e!==t.key));b(e)}},className:"btn-vertical-middle",styles:{root:{width:190}}}):i.createElement(i.Fragment,null,"between"===h?i.createElement("div",null,i.createElement("input",{type:"text",className:"input input-padding",onChange:N,value:g}),i.createElement("span",{className:"and"},"and"),i.createElement("input",{type:"text",className:"input input-padding",onChange:function(e){E(e.target.value)},value:S})):i.createElement("input",{type:"text",className:"input input-padding",onChange:N,value:g})),i.createElement(C.K,{text:"Apply",className:"btn-vertical-middle",onClick:function(){if(!1===d&&""===g)return void alert("Please input related value!");if(g.match(/[a-zA-Z]/)||S.match(/[a-zA-Z]/))return void alert("Please input a number!");let e=JSON.parse(JSON.stringify(a));e.filter((e=>e.name===t)).length>0?d&&0!==v.length||!1===d?e.forEach((e=>{e.name===t&&(e.operator=h,e.value1=g,e.value2=x(),e.choice=v,e.isChoice=!!d)})):e=e.filter((e=>e.name!==t)):(d&&0!==v.length||!1===d)&&e.push({name:t,operator:h,value1:g,value2:x(),choice:v,isChoice:!!d}),c(H(e)),s(e),l(),n()}}))}pe.propTypes={parameter:oe().string,searchFilter:oe().array,dismiss:oe().func,setSearchInputVal:oe().func,changeSearchFilterList:oe().func,updatePage:oe().func};var ge=pe;function fe(e){const{searchName:t,searchFilter:a,dismiss:n,changeSearchFilterList:s,setSearchInputVal:o,updatePage:l}=e,[c,d]=(0,i.useState)(function(){let e="";const i=a.find((e=>e.name===t));void 0!==i&&(e=i.value1);return e}());return i.createElement(r.K,{horizontal:!0,className:"filterConditions",tokens:he.O4},i.createElement("span",null,"Trial id"===t?"Includes":"Equals to"),i.createElement("input",{type:"text",className:"input input-padding",onChange:function(e){d(e.target.value)},value:c}),i.createElement(C.K,{text:"Apply",className:"btn-vertical-middle",onClick:function(){const{searchFilter:a}=e,i=JSON.parse(JSON.stringify(a)),r=i.filter((e=>e.name===t));""!==c?(r.length>0?i.forEach((e=>{e.name===t&&(e.value1=c,e.isChoice=!1)})):i.push({name:t,value1:c,isChoice:!1}),o(H(i)),s(i),l(),n()):alert("Please input related value!")}}))}fe.propTypes={searchName:oe().string,searchFilter:oe().array,dismiss:oe().func,setSearchInputVal:oe().func,changeSearchFilterList:oe().func,updatePage:oe().func};var ye=fe;function Se(e){const{searchFilter:t,changeSearchFilterList:a,updatePage:n}=e,[s,l]=(0,i.useState)("");const c=function(e){const t=[];return e.unshift("StatusNNI"),["Trial id","Trial No."].forEach((e=>{t.push({key:e,text:e,subMenuProps:{items:[{key:e,text:e,onRender:m.bind(e)}]}})})),e.forEach((e=>{t.push({key:e,text:"StatusNNI"===e?"Status":e,subMenuProps:{items:[{key:e,text:e,onRender:d.bind(e)}]}})})),{shouldFocusOnMount:!0,directionalHint:O.b.bottomLeftEdge,className:R.menu,items:t}}(o.O.isNestedExp()?[]:Object.keys(o.O.searchSpace));function d(e,s){return i.createElement(ge,{parameter:e.text,searchFilter:t,changeSearchFilterList:a,updatePage:n,setSearchInputVal:l,dismiss:s})}function m(e,s){return i.createElement(ye,{searchName:e.text,searchFilter:t,changeSearchFilterList:a,setSearchInputVal:l,updatePage:n,dismiss:s})}function u(e){a(e),n()}function h(e){const t=e.trim().slice(1,e.trim().length-1),a=[];if(t.includes(",")){return t.split(",").forEach((e=>{""!==e&&a.push(e)})),a}return""===t?a:[t]}function p(){u([])}return i.createElement("div",null,i.createElement(r.K,{horizontal:!0},i.createElement(g.a,{text:"Filter",menuProps:c}),i.createElement(ue.R,{styles:{root:{width:530}},placeholder:"Search",onChange:function(e,t){l(t)},value:s,onSearch:function(){if(/`~!@#$%^&*()+?"{}.'/im.test(s)||/\xb7\uff01#\uffe5\uff08\u2014\u2014\uff09\uff1a\uff1b\u201c\u201d\u2018\u3001\uff0c|\u300a\u3002\u300b\uff1f\u3001\u3010\u3011[\]]/im.test(s))return void alert("Please delete special characters in the conditions!");const e=s.trim().split(";"),t=[];e.includes("")&&e.splice(e.findIndex((e=>""===e)),1),e.forEach((e=>{if(!(e.endsWith(":")||e.endsWith("<")||e.endsWith(">")||e.endsWith("\u2260"))){let a=[];if(e.includes(">")){const i=!0===e.includes(">")?">":"<";a=e.trim().split(i),t.push({name:a[0],operator:i,value1:a[1].trim(),value2:"",choice:[],isChoice:!1})}else if(e.includes("\u2260")){a=e.trim().split("\u2260");const i="Status"===a[0]?"StatusNNI":a[0],n=V(i);t.push({name:i,operator:"\u2260",value1:n?"":JSON.parse(a[1].trim()),value2:"",choice:n?h(a[1]):[],isChoice:!!n})}else{if(!e.includes(":"))return;{a=e.trim().split(":");const i="Status"===a[0]?"StatusNNI":a[0],n=V(i);!0===!!(a.length>1&&a[1].includes("["))?!0===n?t.push({name:i,operator:"=",value1:"",value2:"",choice:h(a[1]),isChoice:!0}):t.push({name:a[0],operator:"between",value1:JSON.parse(a[1].trim())[0],value2:JSON.parse(a[1].trim())[1],choice:[],isChoice:!1}):t.push({name:a[0],operator:"=",value1:a[1].trim(),value2:"",choice:[],isChoice:!1})}}}})),u(t)},onEscape:p,onClear:p})))}Se.propTypes={searchFilter:oe().array,changeSearchFilterList:oe().func,updatePage:oe().func};var Ee=Se,ve=a(88710),be=a(95319),Ce=a(56919);class Ne extends i.Component{constructor(e){super(e),this.state={isCalloutVisible:!1}}render(){const{isCalloutVisible:e}=this.state;return i.createElement("div",null,i.createElement("div",{className:Ce.W.buttonArea,ref:e=>this.menuButtonElement=e},i.createElement(C.K,{className:"detail-button-operation",onClick:this.openPromot,title:"kill"},B.IN)),e?i.createElement("div",null,i.createElement(ve.y,{role:"alertdialog",className:Ce.W.callout,gapSpace:0,target:this.menuButtonElement,onDismiss:this.onDismiss,setInitialFocus:!0},i.createElement("div",{className:Ce.W.header},i.createElement("p",{className:Ce.W.title,style:{color:"#333"}},"Kill trial")),i.createElement("div",{className:Ce.W.inner},i.createElement("div",null,i.createElement("p",{className:Ce.W.subtext,style:{color:"#333"}},"Are you sure to cancel this trial?"))),i.createElement(be.k,null,i.createElement(r.K,{className:Ce.W.buttons,gap:8,horizontal:!0},i.createElement(g.a,{onClick:this.onDismiss},"No"),i.createElement(C.K,{onClick:this.onKill},"Yes"))))):null)}onDismiss=()=>{this.setState((()=>({isCalloutVisible:!1})))};onKill=()=>{this.setState({isCalloutVisible:!1},(()=>{const{trial:e}=this.props;(0,m.UY)(e.key,e.id,e.status)}))};openPromot=e=>{e.preventDefault(),e.stopPropagation(),this.setState({isCalloutVisible:!0})}}var xe=Ne,Ie=a(45237),ke=a(51342);class Te extends i.Component{render(){const{detailsProps:e,isExpand:t}=this.props;return i.createElement("div",null,i.createElement(Ie.X,e),t&&i.createElement(ke.Z,{trialId:e.item.id}))}}var we=Te,Pe=a(37130),De=a(42918),Me=a.n(De);const Le={childrenGap:20,padding:10};function Oe(e,t,a){return-1===e?0:Math.min(t,Math.floor((a.length-1)/e))*e}function Ke(e,t,a){if(-1===e)return a;{const i=Oe(e,t,a);return a.slice(i,i+e)}}class _e extends i.PureComponent{constructor(e){super(e),this.state={itemsPerPage:20,currentPage:0,itemsOnPage:[]}}_onItemsPerPageSelect(e,t){if(void 0!==t){const{items:e}=this.props,a=Oe(this.state.itemsPerPage,this.state.currentPage,e),i=t.key,n=Math.floor(a/i);this.setState({itemsPerPage:i,currentPage:n,itemsOnPage:Ke(i,n,this.props.items)})}}_onPageSelect(e){const t=e.selected;this.setState({currentPage:t,itemsOnPage:Ke(this.state.itemsPerPage,t,this.props.items)})}componentDidUpdate(e){e.items!==this.props.items&&this.setState({itemsOnPage:Ke(this.state.itemsPerPage,this.state.currentPage,this.props.items)})}render(){const{itemsPerPage:e,itemsOnPage:t}=this.state,a={...this.props,items:t},n=this.props.items.length,s=-1===e?1:Math.ceil(n/e);return i.createElement("div",null,i.createElement(Pe.W,a),i.createElement(r.K,{horizontal:!0,horizontalAlign:"end",verticalAlign:"baseline",styles:{root:{padding:10}},tokens:Le},i.createElement(f.L,{selectedKey:e,options:[{key:10,text:"10 items per page"},{key:20,text:"20 items per page"},{key:50,text:"50 items per page"},{key:-1,text:"All items"}],onChange:this._onItemsPerPageSelect.bind(this),styles:{dropdown:{width:150}}}),i.createElement(Me(),{previousLabel:i.createElement(M.J,{"aria-hidden":!0,iconName:"ChevronLeft"}),nextLabel:i.createElement(M.J,{"aria-hidden":!0,iconName:"ChevronRight"}),breakLabel:"...",breakClassName:"break",pageCount:s,marginPagesDisplayed:2,pageRangeDisplayed:2,onPageChange:this._onPageSelect.bind(this),containerClassName:0===n?"pagination hidden":"pagination",subContainerClassName:"pages pagination",disableInitialCallback:!1,activeClassName:"active"})))}}var Ae=_e,Re=a(25118);a(33509),a(38570),a(21258);const Fe=["sequenceId","id","duration","status","latestAccuracy"];function ze(e){if("sequenceId"===e)return"Trial No.";if("id"===e)return"ID";if("intermediateCount"===e)return"Intermediate results (#)";if("message"===e)return"Message";if(e.startsWith("space/"))return e.split("/",2)[1]+" (space)";if("latestAccuracy"===e)return"Default metric";if(e.startsWith("metric/"))return e.split("/",2)[1]+" (metric)";if(e.startsWith("_"))return e;{const t=e.replace(/[A-Z]/g,(e=>` ${e.toLowerCase()}`));return t.charAt(0).toUpperCase()+t.slice(1)}}class We extends i.Component{constructor(e){super(e),this.state={displayedItems:[],displayedColumns:null!==localStorage.getItem("columns")?JSON.parse(localStorage.getItem("columns")):Fe,columns:[],searchType:"id",searchText:"",customizeColumnsDialogVisible:!1,compareDialogVisible:!1,selectedRowIds:[],intermediateDialogTrial:void 0,copiedTrialId:void 0,sortInfo:{field:"",isDescend:!0},searchItems:[],relation:(0,m.tr)(),intermediateKeyList:[]},this._expandedTrialIds=new Set}_onColumnClick(e,t){const{columns:a}=this.state,i=!a.slice().filter((e=>t.key===e.key))[0].isSortedDescending;this.setState({sortInfo:{field:t.key,isDescend:i}},this._updateTableSource)}_trialsToTableItems(e){const t=o.F.inferredSearchSpace(o.O.searchSpaceNew),a=o.F.inferredMetricSpace(),{selectedRowIds:i}=this.state,n=e.map((e=>{const n={sequenceId:e.sequenceId,id:e.id,_checked:!!i.includes(e.id),startTime:e.info.startTime,endTime:e.info.endTime,duration:e.duration,status:e.status,message:e.info.message||"--",intermediateCount:e.intermediates.length,_expandDetails:this._expandedTrialIds.has(e.id)};for(const[a,i]of e.parameters(t))n[`space/${a.baseName}`]=i;for(const[t,i]of e.metrics(a))n[`metric/${t.baseName}`]=i;return n.latestAccuracy=e.latestAccuracy,n._formattedLatestAccuracy=e.formatLatestAccuracy(),n})),{sortInfo:s}=this.state;return""!==s.field?(0,m.Lc)(n,s.field,s.isDescend):n}selectedTrialOnChangeEvent=(e,t,a)=>{const{displayedItems:i,selectedRowIds:n}=this.state,s=JSON.parse(JSON.stringify(i));let r=n;!1===a?r=r.filter((t=>t!==e)):r.push(e),s.forEach((t=>{t.id===e&&(t._checked=!!a)})),this.setState((()=>({displayedItems:s,selectedRowIds:r})))};changeSelectTrialIds=()=>{const{displayedItems:e}=this.state,t=e;t.forEach((e=>{e._checked=!1})),this.setState((()=>({selectedRowIds:[],displayedItems:t})))};_buildColumnsFromTableItems(e){const t=[{name:"",key:"_selected",fieldName:"selected",minWidth:20,maxWidth:20,isResizable:!0,className:"detail-table",onRender:e=>i.createElement(v.X,{label:void 0,checked:e._checked,className:"detail-check",onChange:this.selectedTrialOnChangeEvent.bind(this,e.id)})},{key:"_expand",name:"",onRender:e=>i.createElement(M.J,{"aria-hidden":!0,iconName:"ChevronRight",className:"cursor",styles:{root:{transition:"all 0.2s",transform:`rotate(${e._expandDetails?90:0}deg)`}},onClick:t=>{t.stopPropagation();const a={...e,_expandDetails:!e._expandDetails};a._expandDetails?this._expandedTrialIds.add(a.id):this._expandedTrialIds.delete(a.id);const i=this.state.displayedItems.map((e=>e.id===a.id?a:e));this.setState({displayedItems:i})},onMouseDown:e=>{e.stopPropagation()},onMouseUp:e=>{e.stopPropagation()}}),fieldName:"expand",isResizable:!1,minWidth:20,maxWidth:20}];for(const n of Object.keys(e[0])){if("metric/default"===n)continue;const e=ze(n),a=.85*window.innerWidth;t.push({name:e,key:n,fieldName:n,minWidth:.12*a,maxWidth:.19*a,isResizable:!0,onColumnClick:this._onColumnClick.bind(this),..."status"===n&&{onRender:e=>i.createElement("span",{className:`${e.status} commonStyle`},e.status)},..."message"===n&&{onRender:e=>e.message.length>15?i.createElement(L.G,{content:e.message,directionalHint:O.b.bottomCenter,tooltipProps:{calloutProps:{styles:{beak:{background:_.he},beakCurtain:{background:_.he},calloutMain:{background:_.he}}}}},i.createElement("div",null,e.message)):i.createElement("div",null,e.message)},...(n.startsWith("metric/")||n.startsWith("space/"))&&{onRender:e=>i.createElement(L.G,{content:e[n],directionalHint:O.b.bottomCenter,tooltipProps:{calloutProps:{styles:{beak:{background:_.he},beakCurtain:{background:_.he},calloutMain:{background:_.he}}}}},i.createElement("div",{className:"ellipsis"},e[n]))},..."latestAccuracy"===n&&{onRender:e=>i.createElement(L.G,{content:e._formattedLatestAccuracy,directionalHint:O.b.bottomCenter,tooltipProps:{calloutProps:{styles:{beak:{background:_.he},beakCurtain:{background:_.he},calloutMain:{background:_.he}}}}},i.createElement("div",{className:"ellipsis"},e._formattedLatestAccuracy))},...["startTime","endTime"].includes(n)&&{onRender:e=>i.createElement("span",null,(0,m.i$)(e[n],"--"))},..."duration"===n&&{onRender:e=>i.createElement("span",{className:"durationsty"},(0,m.BG)(e[n]))},..."id"===n&&{onRender:e=>i.createElement(r.K,{horizontal:!0,className:"idCopy"},i.createElement("div",null,e.id),i.createElement(Re.Z,{value:e.id}))}})}t.push({name:"Operation",key:"_operation",fieldName:"operation",minWidth:150,maxWidth:160,isResizable:!0,className:"detail-table",onRender:this._renderOperationColumn.bind(this)});const{sortInfo:a}=this.state;for(const i of t)i.key===a.field?(i.isSorted=!0,i.isSortedDescending=a.isDescend):(i.isSorted=!1,i.isSortedDescending=!0);return t}_updateTableSource(){const{searchItems:e,relation:t}=this.state;let a=this._trialsToTableItems(this.props.tableSource);if(e.length>0&&(a=z(a,e,t)),a.length>0){const e=this._buildColumnsFromTableItems(a);this.setState({displayedItems:a,columns:e})}else this.setState({displayedItems:[],columns:[]})}_updateDisplayedColumns(e){this.setState({displayedColumns:e})}_renderOperationColumn(e){const t=!["RUNNING","UNKNOWN"].includes(e.status),a=["DONE","ERROR","STOPPED","VIEWED"].includes(o.O.status);return i.createElement(r.K,{className:"detail-button",horizontal:!0},i.createElement(C.K,{className:"detail-button-operation",title:"Intermediate",onClick:()=>{const{tableSource:t}=this.props,a=t.find((t=>t.id===e.id)),i=this.getIntermediateAllKeys(a);this.setState({intermediateDialogTrial:a,intermediateKeyList:i})}},B.wW),t?i.createElement(C.K,{className:"detail-button-operation",disabled:!0,title:"kill"},B.IN):i.createElement(xe,{trial:e}),i.createElement(C.K,{className:"detail-button-operation",title:"Customized trial",onClick:()=>{this.setState({copiedTrialId:e.id})},disabled:a},B.JG))}changeSearchFilterList=e=>{this.setState((()=>({searchItems:e})))};getIntermediateAllKeys=e=>{let t=[];if(void 0!==e.intermediateMetrics&&e.intermediateMetrics[0]){const a=(0,m.Ti)(e.intermediateMetrics[0].data);if(void 0!==a&&"object"===typeof a){const e=[];for(const t in a)"number"===typeof a[t]&&e.push(t);t=e}}return t.includes("default")&&"default"!==t[0]&&(t=t.filter((e=>"default"!==e)),t.unshift("default")),t};componentDidUpdate(e){this.props.tableSource!==e.tableSource&&this._updateTableSource()}componentDidMount(){this._updateTableSource()}render(){const{displayedItems:e,columns:t,customizeColumnsDialogVisible:a,compareDialogVisible:n,displayedColumns:s,selectedRowIds:o,intermediateDialogTrial:l,copiedTrialId:c,searchItems:d,intermediateKeyList:m}=this.state;return i.createElement("div",{id:"tableList"},i.createElement(r.K,{horizontal:!0,className:"panelTitle",style:{marginTop:10}},i.createElement("span",{style:{marginRight:12}},B.zF),i.createElement("span",null,"Trial jobs")),i.createElement(r.K,{horizontal:!0,className:"allList"},i.createElement(K.v,null,i.createElement(r.K,{horizontal:!0,horizontalAlign:"end",className:"allList"},i.createElement(Ee,{searchFilter:d,changeSearchFilterList:this.changeSearchFilterList,updatePage:this.props.updateDetailPage}))),i.createElement(K.v,{styles:{root:{position:"absolute",right:"0"}}},i.createElement(g.a,{className:"allList-button-gap",text:"Add/Remove columns",onClick:()=>{this.setState({customizeColumnsDialogVisible:!0})}}),i.createElement(g.a,{text:"Compare",className:"allList-compare",onClick:()=>{this.setState({compareDialogVisible:!0})},disabled:0===o.length}),i.createElement(me,{selectedRowIds:o,changeSelectTrialIds:this.changeSelectTrialIds}))),t&&e&&i.createElement(Ae,{columns:t.filter((e=>s.includes(e.key)||["_expand","_operation","_selected"].includes(e.key))),items:e,compact:!0,selectionMode:0,selectionPreservedOnEmptyClick:!0,onRenderRow:e=>i.createElement(we,{detailsProps:e,isExpand:e.item._expandDetails})}),n&&i.createElement(te,{title:"Compare trials",showDetails:!0,trials:this.props.tableSource.filter((e=>o.includes(e.id))),onHideDialog:()=>{this.setState({compareDialogVisible:!1})},changeSelectTrialIds:this.changeSelectTrialIds}),void 0!==l&&i.createElement(te,{title:"Intermediate results",showDetails:!1,trials:[l],intermediateKeyList:m,onHideDialog:()=>{this.setState({intermediateDialogTrial:void 0})}}),a&&i.createElement(x,{selectedColumns:s,allColumns:t.filter((e=>!e.key.startsWith("_"))).map((e=>({key:e.key,name:e.name}))),onSelectedChange:this._updateDisplayedColumns.bind(this),onHideDialog:()=>{this.setState({customizeColumnsDialogVisible:!1})},whichComponent:"table"}),i.createElement(se,{visible:void 0!==c,copyTrialId:c||"",closeCustomizeModal:()=>{this.setState({copiedTrialId:void 0})}}))}}var $e=We;a(4928),a(78587),a(42928),a(17900);class He extends i.Component{static contextType=l.I;interAccuracy=0;interAllTableList=2;constructor(e){super(e),this.state={whichChart:"Default metric"}}handleWhichTabs=e=>{this.setState({whichChart:e.props.headerText})};render(){const{whichChart:e}=this.state,t=o.F.toArray(),a=o.F.toArray().map((e=>e.id));return i.createElement(l.I.Consumer,null,(l=>i.createElement(i.Fragment,null,i.createElement("div",{className:"trial",id:"tabsty"},i.createElement(n.o,{defaultSelectedKey:"0",className:"detail-title",onLinkClick:this.handleWhichTabs,selectedKey:e},i.createElement(s.M,{headerText:"Default metric",itemIcon:"HomeGroup",key:"Default metric"},i.createElement(r.K,{className:"graph"},i.createElement(c.Z,{trialIds:a,hasBestCurve:!0,chartHeight:402,changeExpandRowIDs:l.changeExpandRowIDs}))),i.createElement(s.M,{headerText:"Hyper-parameter",itemIcon:"Equalizer",key:"Hyper-parameter"},i.createElement(r.K,{className:"graph"},i.createElement(k,{trials:t,searchSpace:o.O.searchSpaceNew}))),i.createElement(s.M,{headerText:"Duration",itemIcon:"BarChartHorizontal",key:"Duration"},i.createElement(h,{source:t})),i.createElement(s.M,{headerText:"Intermediate result",itemIcon:"StackedLineChart",key:"Intermediate result"},i.createElement(D,{source:t})))),i.createElement("div",{className:"detailTable",style:{marginTop:10}},i.createElement($e,{tableSource:t,updateDetailPage:this.context.updateDetailPage})))))}}var Ve=He},38450:function(e,t,a){var i=a(16449),n=a(87578),s=a(23270),r=a(78800),o=a(30965),l=a(4671);a(76088),a(38570),a(21258);const c={grid:{left:"8%"},xAxis:{name:"Trial",type:"category"},yAxis:{name:"Default metric",type:"value"}};class d extends i.Component{constructor(e){super(e),this.state={bestCurveEnabled:!1,startY:0,endY:100}}loadDefault=(e,t)=>{this.setState({bestCurveEnabled:t})};metricDataZoom=e=>{void 0!==e.batch&&this.setState((()=>({startY:null!==e.batch[0].start?e.batch[0].start:0,endY:null!==e.batch[0].end?e.batch[0].end:100})))};pointClick=e=>{const{hasBestCurve:t}=this.props;t||this.props.changeExpandRowIDs(e.data[2],"chart")};generateGraphConfig(e){const{startY:t,endY:a}=this.state,{hasBestCurve:i}=this.props;return{grid:{left:"8%"},tooltip:{trigger:"item",enterable:i,confine:!0,formatter:e=>`\n                    <div class="tooldetailAccuracy">\n                        <div>Trial No.: ${e.data[0]}</div>\n                        <div>Trial ID: ${e.data[2]}</div>\n                        <div>Default metric: ${e.data[1]}</div>\n                        <div>Parameters: <pre>${JSON.stringify((0,l.cJ)(e.data[3]),null,4)}</pre></div>\n                    </div>\n                `},dataZoom:[{id:"dataZoomY",type:"inside",yAxisIndex:[0],filterMode:"empty",start:t,end:a}],xAxis:{name:"Trial",type:"category"},yAxis:{name:"Default metric",type:"value",scale:!0},series:void 0}}generateScatterSeries(e){return{symbolSize:6,type:"scatter",data:e.map((e=>[e.sequenceId,e.accuracy,e.id,e.description.parameters]))}}generateBestCurveSeries(e){let t=e[0];const a=[[t.sequenceId,t.accuracy,t.id,t.description.parameters]];for(let i=1;i<e.length;i++){const n=e[i],s=n.accuracy-t.accuracy;("minimize"===o.O.optimizeMode?s<0:s>0)?(a.push([n.sequenceId,n.accuracy,t.id,n.description.parameters]),t=n):a.push([n.sequenceId,t.accuracy,t.id,n.description.parameters])}return{type:"line",lineStyle:{color:"#FF6600"},data:a}}render(){const{hasBestCurve:e,chartHeight:t}=this.props,a=this.generateGraph(),o=a===c?"No data":"",l={dataZoom:this.metricDataZoom,click:this.pointClick};return i.createElement("div",null,e&&i.createElement(n.K,{horizontalAlign:"end",className:"default-metric"},i.createElement(s.Z,{label:"Optimization curve",inlineLabel:!0,onChange:this.loadDefault})),i.createElement("div",{className:"default-metric-graph graph"},i.createElement(r.Z,{option:a,style:{width:"100%",height:t,margin:"0 auto"},theme:"nni_theme",notMerge:!0,onEvents:l}),i.createElement("div",{className:"default-metric-noData"},o)))}generateGraph(){const e=o.F.getTrials(this.props.trialIds).filter((e=>e.sortable));if(0===e.length)return c;const t=this.generateGraphConfig(e[e.length-1].sequenceId);return this.state.bestCurveEnabled?t.series=[this.generateBestCurveSeries(e),this.generateScatterSeries(e)]:t.series=[this.generateScatterSeries(e)],t}}t.Z=d},17900:function(){},18394:function(){},42928:function(){},4928:function(){},78587:function(){}}]);
//# sourceMappingURL=467.8e4a40d6.chunk.js.map